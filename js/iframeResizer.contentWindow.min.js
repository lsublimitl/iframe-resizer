/*! iFrame Resizer (iframeSizer.contentWindow.min.js) - v3.5.5 - 2016-06-16
 *  Desc: Include this file in any page being loaded into an iframe
 *        to force the iframe to resize to the content size.
 *  Requires: iframeResizer.min.js on host page.
 *  Copyright: (c) 2016 David J. Bradshaw - dave@bradshaw.net
 *  License: MIT
 */

!function(a,b){"use strict";function S(b,c,d){"addEventListener"in a?b.addEventListener(c,d,!1):"attachEvent"in a&&b.attachEvent("on"+c,d)}function T(b,c,d){"removeEventListener"in a?b.removeEventListener(c,d,!1):"detachEvent"in a&&b.detachEvent("on"+c,d)}function U(a){return a.charAt(0).toUpperCase()+a.slice(1)}function V(a){var b,c,d,e=null,f=0,g=function(){f=W(),e=null,d=a.apply(b,c),e||(b=c=null)};return function(){var h=W();f||(f=h);var i=J-(h-f);return b=this,c=arguments,i<=0||i>J?(e&&(clearTimeout(e),e=null),f=h,d=a.apply(b,c),e||(b=c=null)):e||(e=setTimeout(g,i)),d}}function X(a){return x+"["+z+"] "+a}function Y(b){w&&"object"==typeof a.console&&console.log(X(b))}function Z(b){"object"==typeof a.console&&console.warn(X(b))}function $(){_(),Y("Initialising iFrame ("+location.href+")"),aa(),da(),ca("background",e),ca("padding",i),qa(),ia(),ja(),ea(),sa(),ka(),t=ra(),Ga("init","Init message from host page"),P()}function _(){function a(a){return"true"===a}var d=s.substr(y).split(":");z=d[0],f=b!==d[1]?Number(d[1]):f,j=b!==d[2]?a(d[2]):j,w=b!==d[3]?a(d[3]):w,u=b!==d[4]?Number(d[4]):u,c=b!==d[6]?a(d[6]):c,g=d[7],p=b!==d[8]?d[8]:p,e=d[9],i=d[10],G=b!==d[11]?Number(d[11]):G,t.enable=b!==d[12]&&a(d[12]),C=b!==d[13]?d[13]:C,M=b!==d[14]?d[14]:M}function aa(){function b(){var b=a.iFrameResizer;Y("Reading data from page: "+JSON.stringify(b)),O="messageCallback"in b?b.messageCallback:O,P="readyCallback"in b?b.readyCallback:P,F="targetOrigin"in b?b.targetOrigin:F,p="heightCalculationMethod"in b?b.heightCalculationMethod:p,M="widthCalculationMethod"in b?b.widthCalculationMethod:M}function c(a,b){return"function"==typeof a&&(Y("Setup custom "+b+"CalcMethod"),R[b]=a,a="custom"),a}"iFrameResizer"in a&&Object===a.iFrameResizer.constructor&&(b(),p=c(p,"height"),M=c(M,"width")),Y("TargetOrigin for parent set to: "+F)}function ba(a,b){return-1!==b.indexOf("-")&&(Z("Negative CSS value ignored for "+a),b=""),b}function ca(a,c){b!==c&&""!==c&&"null"!==c&&(document.body.style[a]=c,Y("Body "+a+' set to "'+c+'"'))}function da(){b===g&&(g=f+"px"),ca("margin",ba("margin",g))}function ea(){document.documentElement.style.height="",document.body.style.height="",Y('HTML & body height set to "auto"')}function fa(b){function c(){Ga(b.eventName,b.eventType)}var d={add:function(b){S(a,b,c)},remove:function(b){T(a,b,c)}};b.eventNames&&Array.prototype.map?(b.eventName=b.eventNames[0],b.eventNames.map(d[b.method])):d[b.method](b.eventName),Y(U(b.method)+" event listener: "+b.eventType)}function ga(a){fa({method:a,eventType:"Animation Start",eventNames:["animationstart","webkitAnimationStart"]}),fa({method:a,eventType:"Animation Iteration",eventNames:["animationiteration","webkitAnimationIteration"]}),fa({method:a,eventType:"Animation End",eventNames:["animationend","webkitAnimationEnd"]}),fa({method:a,eventType:"Input",eventName:"input"}),fa({method:a,eventType:"Mouse Up",eventName:"mouseup"}),fa({method:a,eventType:"Mouse Down",eventName:"mousedown"}),fa({method:a,eventType:"Orientation Change",eventName:"orientationchange"}),fa({method:a,eventType:"Print",eventName:["afterprint","beforeprint"]}),fa({method:a,eventType:"Ready State Change",eventName:"readystatechange"}),fa({method:a,eventType:"Touch Start",eventName:"touchstart"}),fa({method:a,eventType:"Touch End",eventName:"touchend"}),fa({method:a,eventType:"Touch Cancel",eventName:"touchcancel"}),fa({method:a,eventType:"Transition Start",eventNames:["transitionstart","webkitTransitionStart","MSTransitionStart","oTransitionStart","otransitionstart"]}),fa({method:a,eventType:"Transition Iteration",eventNames:["transitioniteration","webkitTransitionIteration","MSTransitionIteration","oTransitionIteration","otransitioniteration"]}),fa({method:a,eventType:"Transition End",eventNames:["transitionend","webkitTransitionEnd","MSTransitionEnd","oTransitionEnd","otransitionend"]}),"child"===C&&fa({method:a,eventType:"IFrame Resized",eventName:"resize"})}function ha(a,b,c,d){return b!==a&&(a in c||(Z(a+" is not a valid option for "+d+"CalculationMethod."),a=b),Y(d+' calculation method set to "'+a+'"')),a}function ia(){p=ha(p,o,Ca,"height")}function ja(){M=ha(M,L,Da,"width")}function ka(){!0===c?(ga("add"),va()):Y("Auto Resize disabled")}function la(){Y("Disable outgoing messages"),D=!1}function ma(){Y("Remove event listener: Message"),T(a,"message",La)}function na(){null!==h&&h.disconnect()}function oa(){ga("remove"),na(),clearInterval(v)}function pa(){la(),ma(),!0===c&&oa()}function qa(){var a=document.createElement("div");a.style.clear="both",a.style.display="block",document.body.appendChild(a)}function ra(){function c(){return{x:a.pageXOffset!==b?a.pageXOffset:document.documentElement.scrollLeft,y:a.pageYOffset!==b?a.pageYOffset:document.documentElement.scrollTop}}function d(a){var b=a.getBoundingClientRect(),d=c();return{x:parseInt(b.left,10)+parseInt(d.x,10),y:parseInt(b.top,10)+parseInt(d.y,10)}}function e(a){function c(a){var b=d(a);Y("Moving to in page link (#"+e+") at x: "+b.x+" y: "+b.y),Ka(b.y,b.x,"scrollToOffset")}var e=a.split("#")[1]||a,f=decodeURIComponent(e),g=document.getElementById(f)||document.getElementsByName(f)[0];b!==g?c(g):(Y("In page link (#"+e+") not found in iFrame, so sending to parent"),Ka(0,0,"inPageLink","#"+e))}function f(){""!==location.hash&&"#"!==location.hash&&e(location.href)}function g(){function a(a){function b(a){a.preventDefault(),e(this.getAttribute("href"))}"#"!==a.getAttribute("href")&&S(a,"click",b)}Array.prototype.forEach.call(document.querySelectorAll('a[href^="#"]'),a)}function h(){S(a,"hashchange",f)}function i(){setTimeout(f,l)}function j(){Array.prototype.forEach&&document.querySelectorAll?(Y("Setting up location.hash handlers"),g(),h(),i()):Z("In page linking not fully supported in this browser! (See README.md for IE8 workaround)")}return t.enable?j():Y("In page linking not enabled"),{findTarget:e}}function sa(){Y("Enable public methods"),N.parentIFrame={autoResize:function(b){return!0===b&&!1===c?(c=!0,ka()):!1===b&&!0===c&&(c=!1,oa()),c},close:function(){Ka(0,0,"close"),pa()},getId:function(){return z},getPageInfo:function(b){"function"==typeof b?(Q=b,Ka(0,0,"pageInfo")):(Q=function(){},Ka(0,0,"pageInfoStop"))},moveToAnchor:function(b){t.findTarget(b)},reset:function(){Ja("parentIFrame.reset")},scrollTo:function(b,c){Ka(c,b,"scrollTo")},scrollToOffset:function(b,c){Ka(c,b,"scrollToOffset")},sendMessage:function(b,c){Ka(0,0,"message",JSON.stringify(b),c)},setHeightCalculationMethod:function(b){p=b,ia()},setWidthCalculationMethod:function(b){M=b,ja()},setTargetOrigin:function(b){Y("Set targetOrigin: "+b),F=b},size:function(b,c){var d=""+(b?b:"")+(c?","+c:"");Ga("size","parentIFrame.size("+d+")",b,c)}}}function ta(){0!==u&&(Y("setInterval: "+u+"ms"),v=setInterval(function(){Ga("interval","setInterval: "+u)},Math.abs(u)))}function ua(){function c(a){function b(a){!1===a.complete&&(Y("Attach listeners to "+a.src),a.addEventListener("load",g,!1),a.addEventListener("error",h,!1),k.push(a))}"attributes"===a.type&&"src"===a.attributeName?b(a.target):"childList"===a.type&&Array.prototype.forEach.call(a.target.querySelectorAll("img"),b)}function d(a){k.splice(k.indexOf(a),1)}function e(a){Y("Remove listeners from "+a.src),a.removeEventListener("load",g,!1),a.removeEventListener("error",h,!1),d(a)}function f(a,c,d){e(a.target),Ga(c,d+": "+a.target.src,b,b)}function g(a){f(a,"imageLoad","Image loaded")}function h(a){f(a,"imageLoadFailed","Image load failed")}function i(a){Ga("mutationObserver","mutationObserver: "+a[0].target+" "+a[0].type),a.forEach(c)}function j(){var a=document.querySelector("body"),b={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0};return m=new l(i),Y("Create body MutationObserver"),m.observe(a,b),m}var k=[],l=a.MutationObserver||a.WebKitMutationObserver,m=j();return{disconnect:function(){"disconnect"in m&&(Y("Disconnect body MutationObserver"),m.disconnect(),k.forEach(e))}}}function va(){var b=0>u;a.MutationObserver||a.WebKitMutationObserver?b?ta():h=ua():(Y("MutationObserver not supported in this browser!"),ta())}function wa(a,b){function c(a){var c=/^\d+(px)?$/i;if(c.test(a))return parseInt(a,d);var e=b.style.left,f=b.runtimeStyle.left;return b.runtimeStyle.left=b.currentStyle.left,b.style.left=a||0,a=b.style.pixelLeft,b.style.left=e,b.runtimeStyle.left=f,a}var e=0;return b=b||document.body,"defaultView"in document&&"getComputedStyle"in document.defaultView?(e=document.defaultView.getComputedStyle(b,null),e=null!==e?e[a]:0):e=c(b.currentStyle[a]),parseInt(e,d)}function xa(a){a>J/2&&(J=2*a,Y("Event throttle increased to "+J+"ms"))}function ya(a,b){for(var c=b.length,d=0,e=0,f=U(a),g=W(),h=0;h<c;h++)d=b[h].getBoundingClientRect()[a]+wa("margin"+f,b[h]),d>e&&(e=d);return g=W()-g,Y("Parsed "+c+" HTML elements"),Y("Element position calculated in "+g+"ms"),xa(g),e}function za(a){return[a.bodyOffset(),a.bodyScroll(),a.documentElementOffset(),a.documentElementScroll()]}function Aa(a,b){function c(){return Z("No tagged elements ("+b+") found on page"),n}var d=document.querySelectorAll("["+b+"]");return 0===d.length?c():ya(a,d)}function Ba(){return document.querySelectorAll("body *")}function Ea(a,c,d,e){function f(){n=m,K=o,Ka(n,K,a)}function g(){function a(a,b){var c=Math.abs(a-b)<=G;return!c}return m=b!==d?d:Ca[p](),o=b!==e?e:Da[M](),a(n,m)||j&&a(K,o)}function h(){return!(a in{init:1,interval:1,size:1})}function i(){return p in B||j&&M in B}function k(){Y("No change in size detected")}function l(){h()&&i()?Ja(c):a in{interval:1}||k()}var m,o;g()||"init"===a?(Ha(),f()):l()}function Ga(a,b,c,d){function e(){a in{reset:1,resetPage:1,init:1}||Y("Trigger event: "+b)}function f(){return H&&a in k}f()?Y("Trigger event cancelled: "+a):(e(),Fa(a,b,c,d))}function Ha(){H||(H=!0,Y("Trigger event lock on")),clearTimeout(I),I=setTimeout(function(){H=!1,Y("Trigger event lock off"),Y("--")},l)}function Ia(a){n=Ca[p](),K=Da[M](),Ka(n,K,a)}function Ja(a){var b=p;p=o,Y("Reset trigger event: "+a),Ha(),Ia("reset"),p=b}function Ka(a,c,d,e,f){function g(){b===f?f=F:Y("Message targetOrigin: "+f)}function h(){var g=a+":"+c,h=z+":"+g+":"+d+(b!==e?":"+e:"");Y("Sending message to host page ("+h+")"),E.postMessage(x+h,f)}!0===D&&(g(),h())}function La(b){function c(){return x===(""+b.data).substr(0,y)}function d(){function c(){s=b.data,E=b.source,$(),m=!1,setTimeout(function(){r=!1},l)}document.body?c():(Y("Waiting for page ready"),S(a,"readystatechange",d))}function e(){r?Y("Page reset ignored by init"):(Y("Page size reset by host page"),Ia("resetPage"))}function f(){Ga("resizeParent","Parent window requested size check")}function g(){var a=i();t.findTarget(a)}function h(){return b.data.split("]")[1].split(":")[0]}function i(){return b.data.substr(b.data.indexOf(":")+1)}function j(){return"iFrameResize"in a}function k(){var a=i();Y("MessageCallback called from parent: "+a),O(JSON.parse(a)),Y(" --")}function n(){var a=i();Y("PageInfoFromParent called from parent: "+a),Q(JSON.parse(a)),Y(" --")}function o(){return b.data.split(":")[2]in{true:1,false:1}}function p(){switch(h()){case"reset":e();break;case"resize":f();break;case"inPageLink":case"moveToAnchor":g();break;case"message":k();break;case"pageInfo":n();break;default:j()||o()||Z("Unexpected message ("+b.data+")")}}function q(){!1===m?p():o()?d():Y('Ignored message of type "'+h()+'". Received before initialization.')}c()&&q()}function Ma(){"loading"!==document.readyState&&a.parent.postMessage("[iFrameResizerChild]Ready","*")}var c=!0,d=10,e="",f=0,g="",h=null,i="",j=!1,k={resize:1,click:1},l=128,m=!0,n=1,o="bodyOffset",p=o,q=200,r=!0,s="",t={},u=32,v=null,w=!1,x="[iFrameSizer]",y=x.length,z="",B={max:1,min:1,bodyScroll:1,documentElementScroll:1},C="child",D=!0,E=a.parent,F="*",G=0,H=!1,I=null,J=16,K=1,L="scroll",M=L,N=a,O=function(){Z("MessageCallback function not defined")},P=function(){},Q=function(){},R={height:function(){return Z("Custom height calculation function not defined"),document.documentElement.offsetHeight},width:function(){return Z("Custom width calculation function not defined"),document.body.scrollWidth}},W=Date.now||function(){return(new Date).getTime()},Ca={bodyOffset:function(){return document.body.offsetHeight+wa("marginTop")+wa("marginBottom")},offset:function(){return Ca.bodyOffset()},bodyScroll:function(){return document.body.scrollHeight},custom:function(){return R.height()},documentElementOffset:function(){return document.documentElement.offsetHeight},documentElementScroll:function(){return document.documentElement.scrollHeight},max:function(){return Math.max.apply(null,za(Ca))},min:function(){return Math.min.apply(null,za(Ca))},grow:function(){return Ca.max()},lowestElement:function(){return q+Math.max(Ca.bodyOffset(),ya("bottom",Ba()))},taggedElement:function(){return Aa("bottom","data-iframe-height")}},Da={bodyScroll:function(){return document.body.scrollWidth},bodyOffset:function(){return document.body.offsetWidth},custom:function(){return R.width()},documentElementScroll:function(){return document.documentElement.scrollWidth},documentElementOffset:function(){return document.documentElement.offsetWidth},scroll:function(){return Math.max(Da.bodyScroll(),Da.documentElementScroll())},max:function(){return Math.max.apply(null,za(Da))},min:function(){return Math.min.apply(null,za(Da))},rightMostElement:function(){return ya("right",Ba())},taggedElement:function(){return Aa("right","data-iframe-width")}},Fa=V(Ea);S(a,"message",La),Ma()}(window||{});
//# sourceMappingURL=iframeResizer.contentWindow.map
